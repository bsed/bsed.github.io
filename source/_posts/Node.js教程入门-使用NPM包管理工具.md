---
title: "Node.js教程入门-使用NPM包管理工具"
categories: [ "JS" ]
tags: [ "nodejs","npm" ]
draft: false
slug: "nodejs-tutorial-entry-use-npm-package-management-tools"
date: "2017-01-05 12:39:00"
---

> 在本章中，您将了解NPM是什么以及如何使用它。让我们开始吧！

## 什么是NPM

NPM是Node.js的包管理器，你可以找到大量的模块。在这里，所以你不需要重新发明轮子。它像java的maven或PHP的Composer一样。这里有两个主要的接口，NPM网站和NPM命令行工具包,里面的模块是一样的。

### NPM网站

NPM网站可以在[https://npmjs.com](https://npmjs.com)找到。在这里，您可以注册为新用户或搜索软件包。

[node_hero_using_npm_tutorial.webp][1]
<!--more-->


### 命令行界面
要运行CLI，您可以使用以下命令简单地运行：
```bash
npm
```
**注意**，`NPM`与`Node.js`二进制文件捆绑在一起，因此您不必安装它。 但是，如果要使用**特定**的npm版本，您可以更新它。如果你想安装npm版本3，你可以这样做：`npm install npm@3 -g`。

## 使用NPM
当您创建`package.json`文件时，在上一篇[关于Node.js入门的文章](https://tygasoft.com/2017/01/04/nodejs-tutorial-entry-node-hero.html)中，您已经遇到了NPM。让我们继续认识它吧。

### 添加依赖
**在本节中，您将学习如何向应用程序添加运行时依赖关系。**

一旦你有了`package.json`文件后，你可以添加依赖项到你的应用程序。让我们添加一个！尝试以下操作：

```bash
npm install lodash --save  
```

这一命令我们可以实现两件事情：首先，下载`lodash`并放置到`node_modules`文件夹。这是所有*外部依赖项将被放置的文件夹*。通常，你不想将此文件夹添加到源代码管理，所以如果你使用Git确保添加到`gitignore`文件。

下面是`.gitignore`文件内容
```
# Logs
logs
*.log
npm-debug.log*

# Runtime data
pids
*.pid
*.seed

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage

# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# node-waf configuration
.lock-wscript

# Compiled binary addons (http://nodejs.org/api/addons.html)
build/Release

# Dependency directories
node_modules
jspm_packages

# Optional npm cache directory
.npm

# Optional REPL history
.node_repl_history
```

让我们来看看`package.json`文件中发生了什么！一个名为`dependencies`的新属性出现了，如下：
```json
"dependencies": {
  "lodash": "4.6.1"
}
```
这意味着版本`4.6.1`的`lodash`现在已安装并准备使用。注意，NPM遵循`SemVer` 版本包。更多信息：[http://semver.org/](http://semver.org/)

 - 给定一个版本号`major.minor.patch`，
 - 增量主要版本当你做出不兼容的API的变化，
 - 次要版本当你添加功能在向后兼容的方式，
 - 补丁版本当你向后兼容的bug修复。

由于`lodash`已经下载安装好，让我们看看我们如何做到这一点！你可以用你自己的模块做同样的方式，除了现在你不必定义路径，只有模块的名称：
```javascript
// index.js
const _ = require('lodash')

_.assign({ 'a': 1 }, { 'b': 2 }, { 'c': 3 });  
// → { 'a': 1, 'b': 2, 'c': 3 }
```
### 添加开发依赖关系

**在本节中，您将学习如何向应用程序添加`build time`依赖项。**

当您构建Web应用程序时，您可能需要缩小JavaScript文件，连接CSS文件等。将执行它的模块将只在assets的构建期间运行，因此正在运行的应用程序不需要它们。

您可以安装以下脚本：

```bash
npm install mocha --save-dev  
```
一旦你这样做，一个新的部分将出现在`package.json`文件中，名为`devDependencies`。所有使用`--save-dev`安装的模块都将放在那里,它们将放在同一个`node_modules`目录中。

## NPM Scripts

`NPM Scripts`是一个非常强大的概念。借助它们，您可以构建小型实用程序，甚至构建复杂的构建系统。

最常见的是`启动脚本`和`测试脚本`。通过开始，您可以定义应该如何启动应用程序，而测试用于运行测试。在你的package.json中，他们可以看起来像这样：

```json
  "scripts": {
    "start": "node index.js",
    "test": "mocha test",
    "your-custom-script": "echo npm"
  }
```

*这里注意事项：*

 - `start`：很简单，它描述了你的应用程序的启动入口，它可以用`npm start`调用
 - `test`：这个是运行你的测试脚本文件， 在这种情况下，`mocha`是不需要全局安装，因为`npm`会在`node_modules /.bin`文件夹中找到它，`mocha`也会放在那里。它可以使用`npm test`调用
 - `your-custom-script`：任何你想要的，你可以选择任何名字。它可以使用`npm run your-custom-script`运行你的自定义脚本调用 - 不要忘记运行部分！
 
## 作用域/私有包

最初NPM有一个全局共享命名空间的模块名称 - 在注册仓库中有大于250.000个模块，大多数简单的名称已经采取。此外，全局命名空间仅包含公共模块

NPM通过引入作用域包来解决这个问题。作用域包具有以下命名模式：

```bash
@myorg/mypackage
```

您可以按照以前的方式安装作用域包：
```bash
npm install @myorg/mypackage --save-dev  
```

它将以下列方式显示在`package.json`中：
```bash
"dependencies": {
  "@myorg/mypackage": "^1.0.0"
}
```

引入作用域包
```bash
require('@myorg/mypackage')  
```


  [1]: https://imgs.gnux.cn/usr/uploads/2017/01/66338177.webp